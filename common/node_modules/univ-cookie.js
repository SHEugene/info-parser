/* globals document: true, window: true */
var Cookies = require('cookies-js');

var univCookies = {
	get: function (name) {
		if (isBrowser()) {
			return Cookies.get(name);
		} else {
			throw new Error('Currently only browser usage is supported');
			// TODO
		}
	},
	set: function (name, value, options) {
		if (isBrowser()) {
			return Cookies.set(name, value, options);
		} else {
			throw new Error('Currently only browser usage is supported');
		}
	},
	remove: function (name, options) {
		if (isBrowser()) {
			return Cookies.expire(name, options);
		} else {
			throw new Error('Currently only browser usage is supported');
			// TODO
		}
	},
	removeAll: function (name) {
		var pathname = window.location.pathname.replace(/\/$/, '');
		var segments = pathname.split('/');

		for (var i = 0, l = segments.length, path; i < l; i++) {
			path = segments.slice(0, i + 1).join('/');
			univCookies.remove(name, { path: path });       // as file
			univCookies.remove(name, { path: path + '/' }); // as directory
		}

	}
};

function isBrowser () {
	return typeof document !== 'undefined';
}

module.exports = univCookies;
